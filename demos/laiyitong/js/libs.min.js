var SpinningWheel={cellHeight:44,friction:.003,slotData:[],handleEvent:function(t){"touchstart"==t.type?(this.lockScreen(t),"sw-cancel"==t.currentTarget.id||"sw-done"==t.currentTarget.id?this.tapDown(t):"sw-frame"==t.currentTarget.id&&this.scrollStart(t)):"touchmove"==t.type?(this.lockScreen(t),"sw-cancel"==t.currentTarget.id||"sw-done"==t.currentTarget.id?this.tapCancel(t):"sw-frame"==t.currentTarget.id&&this.scrollMove(t)):"touchend"==t.type||"click"==t.type?"sw-cancel"==t.currentTarget.id||"sw-done"==t.currentTarget.id?this.tapUp(t):"sw-frame"==t.currentTarget.id&&(this.scrollEnd(t),this.scrollOver&&this.scrollOver()):"webkitTransitionEnd"==t.type?"sw-wrapper"==t.target.id?this.destroy():this.backWithinBoundaries(t):"orientationchange"==t.type?this.onOrientationChange(t):"scroll"==t.type&&this.onScroll(t)},onOrientationChange:function(t){window.scrollTo(0,0),this.swWrapper.style.top=window.innerHeight+window.pageYOffset+"px",this.calculateSlotsWidth()},onScroll:function(t){this.swWrapper.style.top=window.innerHeight+window.pageYOffset+"px"},lockScreen:function(t){t.preventDefault(),t.stopPropagation()},reset:function(){this.slotEl=[],this.activeSlot=null,this.swWrapper=void 0,this.swSlotWrapper=void 0,this.swSlots=void 0,this.swFrame=void 0},calculateSlotsWidth:function(){for(var t=this.swSlots.getElementsByTagName("div"),i=0;i<t.length;i+=1)this.slotEl[i].slotWidth=t[i].offsetWidth},create:function(t){var i,s,e,o,l;for(this.reset(),l=document.createElement("div"),l.id="sw-wrapper",l.style.top=window.innerHeight+window.pageYOffset+"px",l.style.webkitTransitionProperty="-webkit-transform",l.innerHTML='<div id="sw-header"><a href="javascript:;" id="sw-cancel">取消</a>'+t+'<a href="javascript:;" id="sw-done">确定</a></div><div id="sw-slots-wrapper"><div id="sw-slots"></div></div><div id="sw-frame"></div><div id="sw-line-top"></div><div id="sw-line-bottom"></div>',document.body.appendChild(l),this.swWrapper=l,this.swSlotWrapper=document.getElementById("sw-slots-wrapper"),this.swSlots=document.getElementById("sw-slots"),this.swFrame=document.getElementById("sw-frame"),s=0;s<this.slotData.length;s+=1){o=document.createElement("ul"),e="";for(i in this.slotData[s].values)e+="<li>"+this.slotData[s].values[i]+"</li>";o.innerHTML=e,l=document.createElement("div"),l.className=this.slotData[s].style,l.appendChild(o),this.swSlots.appendChild(l),o.slotPosition=s,o.slotYPosition=0,o.slotWidth=0,o.slotMaxScroll=this.swSlotWrapper.clientHeight-o.clientHeight-2*this.cellHeight,o.style.webkitTransitionTimingFunction="cubic-bezier(0, 0, 0.2, 1)",this.slotEl.push(o),this.slotData[s].defaultValue&&this.scrollToValue(s,this.slotData[s].defaultValue)}this.calculateSlotsWidth(),document.addEventListener("touchstart",this,!1),document.addEventListener("touchmove",this,!1),window.addEventListener("orientationchange",this,!0),window.addEventListener("scroll",this,!0),document.getElementById("sw-cancel").addEventListener("touchend",this,!1),document.getElementById("sw-done").addEventListener("touchend",this,!1),this.swFrame.addEventListener("touchstart",this,!1)},open:function(t){this.create(t),this.swWrapper.style.webkitTransitionTimingFunction="ease-out",this.swWrapper.style.webkitTransitionDuration="400ms",this.swWrapper.style.webkitTransform="translate3d(0, -260px, 0)",this.activeEl()},destroy:function(){this.swWrapper.removeEventListener("webkitTransitionEnd",this,!1),this.swFrame.removeEventListener("touchstart",this,!1),document.getElementById("sw-cancel").removeEventListener("touchstart",this,!1),document.getElementById("sw-done").removeEventListener("touchstart",this,!1),document.removeEventListener("touchstart",this,!1),document.removeEventListener("touchmove",this,!1),window.removeEventListener("orientationchange",this,!0),window.removeEventListener("scroll",this,!0),this.slotData=[],this.cancelAction=function(){return!1},this.cancelDone=function(){return!0},this.reset(),document.body.removeChild(document.getElementById("sw-wrapper"))},close:function(){this.swWrapper.style.webkitTransitionTimingFunction="ease-in",this.swWrapper.style.webkitTransitionDuration="0ms",this.swWrapper.style.webkitTransform="translate3d(0, 0, 0)",this.swWrapper.addEventListener("webkitTransitionEnd",this,!1),this.destroy()},addSlot:function(t,i,s){i||(i=""),i=i.split(" ");for(var e=0;e<i.length;e+=1)i[e]="sw-"+i[e];i=i.join(" ");var o={values:t,style:i,defaultValue:s};this.slotData.push(o)},getSelectedValues:function(){var t,i,s,e,o=[],l=[];for(s in this.slotEl){this.slotEl[s].removeEventListener("webkitTransitionEnd",this,!1),this.slotEl[s].style.webkitTransitionDuration="0",this.slotEl[s].slotYPosition>0?this.setPosition(s,0):this.slotEl[s].slotYPosition<this.slotEl[s].slotMaxScroll&&this.setPosition(s,this.slotEl[s].slotMaxScroll),t=-Math.round(this.slotEl[s].slotYPosition/this.cellHeight),i=0;for(e in this.slotData[s].values){if(i==t){o.push(e),l.push(this.slotData[s].values[e]);break}i+=1}}return{keys:o,values:l}},setPosition:function(t,i){this.slotEl[t].slotYPosition=i,this.slotEl[t].style.webkitTransform="translate3d(0, "+i+"px, 0)"},scrollStart:function(t){for(var i=t.targetTouches[0].clientX-this.swSlots.offsetLeft,s=0,e=0;e<this.slotEl.length;e+=1)if(s+=this.slotEl[e].slotWidth,i<s){this.activeSlot=e;break}if(this.slotData[this.activeSlot].style.match("readonly"))return this.swFrame.removeEventListener("touchmove",this,!1),this.swFrame.removeEventListener("touchend",this,!1),!1;this.slotEl[this.activeSlot].removeEventListener("webkitTransitionEnd",this,!1),this.slotEl[this.activeSlot].style.webkitTransitionDuration="0";var o=window.getComputedStyle(this.slotEl[this.activeSlot]).webkitTransform;return o=new WebKitCSSMatrix(o).m42,o!=this.slotEl[this.activeSlot].slotYPosition&&this.setPosition(this.activeSlot,o),this.startY=t.targetTouches[0].clientY,this.scrollStartY=this.slotEl[this.activeSlot].slotYPosition,this.scrollStartTime=t.timeStamp,this.swFrame.addEventListener("touchmove",this,!1),this.swFrame.addEventListener("touchend",this,!1),!0},scrollMove:function(t){var i=t.targetTouches[0].clientY-this.startY;(this.slotEl[this.activeSlot].slotYPosition>0||this.slotEl[this.activeSlot].slotYPosition<this.slotEl[this.activeSlot].slotMaxScroll)&&(i/=2),this.setPosition(this.activeSlot,this.slotEl[this.activeSlot].slotYPosition+i),this.startY=t.targetTouches[0].clientY,t.timeStamp-this.scrollStartTime>80&&(this.scrollStartY=this.slotEl[this.activeSlot].slotYPosition,this.scrollStartTime=t.timeStamp)},scrollEnd:function(t){if(this.swFrame.removeEventListener("touchmove",this,!1),this.swFrame.removeEventListener("touchend",this,!1),this.slotEl[this.activeSlot].slotYPosition>0||this.slotEl[this.activeSlot].slotYPosition<this.slotEl[this.activeSlot].slotMaxScroll)return this.scrollTo(this.activeSlot,this.slotEl[this.activeSlot].slotYPosition>0?0:this.slotEl[this.activeSlot].slotMaxScroll),!1;var i=this.slotEl[this.activeSlot].slotYPosition-this.scrollStartY;if(i<this.cellHeight/1.5&&i>-this.cellHeight/1.5)return this.slotEl[this.activeSlot].slotYPosition%this.cellHeight&&this.scrollTo(this.activeSlot,Math.round(this.slotEl[this.activeSlot].slotYPosition/this.cellHeight)*this.cellHeight,"100ms"),!1;var s=t.timeStamp-this.scrollStartTime,e=2*i/s/this.friction,o=this.friction/2*(e*e);e<0&&(e=-e,o=-o);var l=this.slotEl[this.activeSlot].slotYPosition+o;return l>0?(l/=2,e/=3,l>this.swSlotWrapper.clientHeight/4&&(l=this.swSlotWrapper.clientHeight/4)):l<this.slotEl[this.activeSlot].slotMaxScroll?(l=(l-this.slotEl[this.activeSlot].slotMaxScroll)/2+this.slotEl[this.activeSlot].slotMaxScroll,e/=3,l<this.slotEl[this.activeSlot].slotMaxScroll-this.swSlotWrapper.clientHeight/4&&(l=this.slotEl[this.activeSlot].slotMaxScroll-this.swSlotWrapper.clientHeight/4)):l=Math.round(l/this.cellHeight)*this.cellHeight,this.scrollTo(this.activeSlot,Math.round(l),Math.round(e)+"ms"),!0},activeEl:function(){for(idx in this.slotEl)for(var t=this.slotEl[idx],i=t.getElementsByTagName("li"),s=0,e=i.length;s<e;s++){var o=i[s];-o.offsetTop==t.slotYPosition-2*this.cellHeight?o.className="sw-active":o.className=""}},scrollTo:function(t,i,s){this.slotEl[t].style.webkitTransitionDuration=s?s:"100ms",this.setPosition(t,i?i:0),(this.slotEl[t].slotYPosition>0||this.slotEl[t].slotYPosition<this.slotEl[t].slotMaxScroll)&&this.slotEl[t].addEventListener("webkitTransitionEnd",this,!1),this.activeEl()},scrollToValue:function(t,i){var s,e,o;this.slotEl[t].removeEventListener("webkitTransitionEnd",this,!1),this.slotEl[t].style.webkitTransitionDuration="0",e=0;for(o in this.slotData[t].values){if(o==i){s=e*this.cellHeight,this.setPosition(t,s);break}e-=1}this.activeEl()},backWithinBoundaries:function(t){return t.target.removeEventListener("webkitTransitionEnd",this,!1),this.scrollTo(t.target.slotPosition,t.target.slotYPosition>0?0:t.target.slotMaxScroll,"150ms"),!1},tapDown:function(t){t.currentTarget.addEventListener("touchmove",this,!1),t.currentTarget.addEventListener("touchend",this,!1),t.currentTarget.className="sw-pressed"},tapCancel:function(t){t.currentTarget.removeEventListener("touchmove",this,!1),t.currentTarget.removeEventListener("touchend",this,!1),t.currentTarget.className=""},tapUp:function(t){this.tapCancel(t),"sw-cancel"==t.currentTarget.id?this.cancelAction():this.doneAction(),this.close()},setCancelAction:function(t){this.cancelAction=t},setDoneAction:function(t){this.doneAction=t},cancelAction:function(){return!1},cancelDone:function(){return!0}};