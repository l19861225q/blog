/*
 * Big V1.0.0
 * Copyright ©2015 KevinLQ's House All Rights Reserved.
 */

"use strict";var App=angular.module("App",["ngRoute","angular-md5"]);App.config(function($routeProvider,$locationProvider){var modulesTemplate="document/modules_template.html";$routeProvider.when("/",{redirectTo:"/home"}).when("/home",{templateUrl:"document/home.html"}).when("/start",{templateUrl:"document/start.html"}).when("/global",{templateUrl:"document/global.html"}).when("/components",{templateUrl:"document/components.html"}).when("/modules",{templateUrl:"document/modules.html"}).when("/modules-header-layout-fixed",{templateUrl:modulesTemplate,controller:"routeController",resolve:{result:function(remoteDOMParseService){return remoteDOMParseService.parse("Header Layout -Fixed","layout/header_fixed.html")}}}).when("/modules-header-layout-shift",{templateUrl:modulesTemplate,controller:"routeController",resolve:{result:function(remoteDOMParseService){return remoteDOMParseService.parse("Header Layout -Shift","layout/header_shift.html")}}}).when("/modules-main-layout-fixed",{templateUrl:modulesTemplate,controller:"routeController",resolve:{result:function(remoteDOMParseService){return remoteDOMParseService.parse("Main Layout -Fixed","layout/main_fixed.html")}}}).when("/modules-main-layout-shift",{templateUrl:modulesTemplate,controller:"routeController",resolve:{result:function(remoteDOMParseService){return remoteDOMParseService.parse("Main Layout -Shift","layout/main_shift.html")}}}).when("/modules-comment-panel",{templateUrl:modulesTemplate,controller:"routeController",resolve:{result:function(remoteDOMParseService){return remoteDOMParseService.parse("Comment Panel","comment/comment.html","yes")}}}).when("/modules-like-panel",{templateUrl:modulesTemplate,controller:"routeController",resolve:{result:function(remoteDOMParseService){return remoteDOMParseService.parse("Like Panel","like/like.html")}}}).when("/modules-download-bar-full",{templateUrl:modulesTemplate,controller:"routeController",resolve:{result:function(remoteDOMParseService){return remoteDOMParseService.parse("Download Bar -Full","download_bar/download_bar_full.html")}}}).when("/modules-download-bar-partial",{templateUrl:modulesTemplate,controller:"routeController",resolve:{result:function(remoteDOMParseService){return remoteDOMParseService.parse("Download Bar -Partial","download_bar/download_bar_partial.html")}}}).when("/modules-profile-item",{templateUrl:modulesTemplate,controller:"routeController",resolve:{result:function(remoteDOMParseService){return remoteDOMParseService.parse("Profile Item","profile/profile_item.html")}}}).when("/modules-profile-block",{templateUrl:modulesTemplate,controller:"routeController",resolve:{result:function(remoteDOMParseService){return remoteDOMParseService.parse("Profile Block","profile/profile_block.html")}}}).when("/modules-profile-block-publisher",{templateUrl:modulesTemplate,controller:"routeController",resolve:{result:function(remoteDOMParseService){return remoteDOMParseService.parse("Profile Block -Publisher","profile/profile_block_publisher.html")}}}).when("/modules-profile-recommend",{templateUrl:modulesTemplate,controller:"routeController",resolve:{result:function(remoteDOMParseService){return remoteDOMParseService.parse("Profile Recommend","profile/profile_recommend.html","yes")}}}).when("/modules-brand-item",{templateUrl:modulesTemplate,controller:"routeController",resolve:{result:function(remoteDOMParseService){return remoteDOMParseService.parse("Brand Item","brand/brand_item.html")}}}).when("/modules-article-header",{templateUrl:modulesTemplate,controller:"routeController",resolve:{result:function(remoteDOMParseService){return remoteDOMParseService.parse("Article Header","article/article_header.html")}}}).when("/modules-article-quote",{templateUrl:modulesTemplate,controller:"routeController",resolve:{result:function(remoteDOMParseService){return remoteDOMParseService.parse("Article Quote","article/article_quote.html","yes")}}}).when("/modules-meta-block",{templateUrl:modulesTemplate,controller:"routeController",resolve:{result:function(remoteDOMParseService){return remoteDOMParseService.parse("Meta Block","meta_block/meta_block.html")}}}).when("/modules-topic-header",{templateUrl:modulesTemplate,controller:"routeController",resolve:{result:function(remoteDOMParseService){return remoteDOMParseService.parse("Topic Header","topic/topic_header.html")}}}).when("/modules-topic-block",{templateUrl:modulesTemplate,controller:"routeController",resolve:{result:function(remoteDOMParseService){return remoteDOMParseService.parse("Topic Block","topic/topic_block.html")}}}).when("/pages",{templateUrl:"document/pages.html"}).when("/pages-detail",{templateUrl:modulesTemplate,controller:"routeController",resolve:{result:function(remoteDOMParseService){return remoteDOMParseService.parse("Detail Page","example/detail.html","yes","whole")}}}).when("/pages-topic",{templateUrl:modulesTemplate,controller:"routeController",resolve:{result:function(remoteDOMParseService){return remoteDOMParseService.parse("Topic Page","example/topic.html","yes","whole")}}}).when("/download",{templateUrl:"document/download.html"}),$locationProvider.hashPrefix("!")}),App.run(["$rootScope","md5",function($rootScope,md5){$("body").delegate(".nav-tabs a","click",function(){var $this=$(this),$targetEl=$($this.data("target"));$this.parent().addClass("active").siblings().removeClass("active"),$(".tab-pane.active").removeClass("active"),$targetEl.addClass("active")}),$rootScope.$on("$routeChangeStart",function(event,curRoute){if(curRoute.originalPath&&"/"!=curRoute.originalPath&&"/home"!=curRoute.originalPath){var secret=sessionStorage.secret;void 0==secret&&(secret=prompt("请输入访问口令："));var _secret=md5.createHash(secret||"");"ebaad142ac53ead25bce3d156f92682b"===_secret?sessionStorage.secret=secret:(alert("口令错误！"),location.href="#!/home",event.preventDefault())}})}]),App.controller("navController",function($scope,$location){$scope.isActiveStart=function(viewLocation){return $location.path().indexOf(viewLocation)>-1},$scope.isActiveEqual=function(viewLocation){return viewLocation===$location.path()}}),App.controller("routeController",function($scope,result){$scope.title=result.title,$scope.url=result.url,$scope.code=result.code,$scope.iframeScroll=result.iframeScroll}),App.factory("remoteDOMParseService",function($q,$http){return{parse:function(title,url,iframeScroll,wholePage){var iframeScroll=iframeScroll||"no",wholePage="whole"===wholePage?!0:!1,deferred=$q.defer();return $http.get(url).then(function(response){var parser=new DOMParser,code=wholePage?response.data:$(parser.parseFromString(response.data,"text/html")).find("body").html();deferred.resolve({title:title,url:url,code:code,iframeScroll:iframeScroll})}),deferred.promise}}});